-- ================================================================= --
-- NTBA FARM HUB - V21.2.6 (ÄÃƒ Sá»¬A Lá»–I UI AUTO HAKI)
-- CHÃš THÃCH Cáº¬P NHáº¬T:
-- 1. HoÃ n thiá»‡n viá»‡c tÃ­ch há»£p GUI vÃ  logic Ä‘iá»u khiá»ƒn cho Auto Haki/Auto Q vÃ o Panel "AutoHaki" cá»§a Hub.
-- 2. Äáº£m báº£o cÃ¡c nÃºt chá»©c nÄƒng hoáº¡t Ä‘á»™ng Ä‘Ãºng khi cháº¡y qua Xeno.
-- ================================================================= --

local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local player = Players.LocalPlayer
local Character = player.Character or player.CharacterAdded:Wait()
local hrp = Character:WaitForChild("HumanoidRootPart")
local Backpack = player:WaitForChild("Backpack")
local CoreGui = game:GetService("CoreGui")

-- ================================================================= --
-- BIáº¾N Há»† THá»NG CHUNG & AUTO HAKI
-- ================================================================= --
local AutoFarmNPC = false
local FarmRadius = 150
local AutoSkillState={Z=false,X=false,C=false,V=false}
local AutoDropItem = false
local AutoDropItemPlus = falseÂ 
local Hotkey = Enum.KeyCode.RightControl
local HubVisible = true
local GodModeState = false

-- [[ THÃ”NG Sá» LOOT FRUIT MIX (CHEST) ]]
local AutoCollectChestState = false
local CollectChestRadius = 250
local CHEST_MODEL_NAME = "Crate"Â 
local CLICKABLE_PART_NAME = "Crate"Â 

-- BIáº¾N AUTO HAKI
local DEFAULT_KEY = "R"
local SECONDARY_KEY = "Q"Â 
local DEFAULT_INTERVAL = 0.15
local SAMPLE_WINDOW = 6
local MIN_INTERVAL = 0.02
local MAX_INTERVAL = 3

local isRunningR = false Â -- Tráº¡ng thÃ¡i cháº¡y cho phÃ­m R (chá»©c nÄƒng chÃ­nh)
local isRunningQ = false Â -- Tráº¡ng thÃ¡i cháº¡y cho phÃ­m Q
local currentMode = "Adaptive"

local CooldownData = {
Â  Â  pressCount = 0,
Â  Â  successCount = 0,
Â  Â  lastSamples = {},
Â  Â  lastPressTime = 0
}
local HakiUIControls = {} -- LÆ°u trá»¯ cÃ¡c Ä‘á»‘i tÆ°á»£ng UI cho Haki

-- DANH SÃCH DROP CÅ¨ VÃ€ Má»šI (KHÃ”NG THAY Äá»”I)
local ITEM_DROP_LIST = {
Â  Â  ["Apple"] = true, ["Cantaloup"] = true, ["Cantaloupe"] = true, ["Banana"] = true,
Â  Â  ["Green Apple"] = true, ["Coconut"] = true, ["Pumpkin"] = true,
Â  Â  ["Prickly Pear"] = true, ["Melon"] = true,
}
local ITEM_DROP_PLUS_LIST = {
Â  Â  ["Cider+"] = true, ["Lemonade+"] = true, ["Juice+"] = true, ["Smoothie+"] = true,
}

local function findDroppableItemInList(dropList)
Â  Â  for _, item in ipairs(Backpack:GetChildren()) do
Â  Â  Â  Â  if (item:IsA("Tool") or item:IsA("HopperBin")) and dropList[item.Name] then
Â  Â  Â  Â  Â  Â  return item
Â  Â  Â  Â  end
Â  Â  end
Â  Â  return nil
end

player.CharacterAdded:Connect(function(newCharacter)
Â  Â  Character = newCharacter
Â  Â  hrp = Character:WaitForChild("HumanoidRootPart")
Â  Â  if GodModeState then task.wait(0.2) end
end)

pcall(function()
Â  Â  if player:FindFirstChild("PlayerGui") and player.PlayerGui:FindFirstChild("FruitHubUI") then
Â  Â  Â  Â  player.PlayerGui.FruitHubUI:Destroy()
Â  Â  end
end)

local PlayerGui = player:WaitForChild("PlayerGui", 5)
if not PlayerGui then return end

-- ================================================================= --
-- HÃ€M CORE CHO AUTO HAKI
-- ================================================================= --

local function doKeyTap(keyName)
Â  Â  pcall(function()
Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(true, keyName, false, game)
Â  Â  Â  Â  task.wait(0.01)
Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(false, keyName, false, game)
Â  Â  end)
Â  Â  return true
end

local function simpleClamp(n, lo, hi)
Â  Â  return math.max(lo, math.min(hi, n))
end

local function simpleInterval(txt)
Â  Â  local n = tonumber(txt) or DEFAULT_INTERVAL
Â  Â  return simpleClamp(n, MIN_INTERVAL, MAX_INTERVAL)
end

local function simpleReadGUI(obj)
Â  Â  if not obj or not obj:IsA("GuiObject") then return nil end
Â  Â  return obj.Size.X.Scale
end

local function simpleFindGUI()
Â  Â  local pg = player and player:FindFirstChild("PlayerGui")
Â  Â  if not pg then return nil end
Â  Â  
Â  Â  for _, obj in ipairs(pg:GetDescendants()) do
Â  Â  Â  Â  -- Thá»­ tÃ¬m cÃ¡c thanh bar trong game phá»• biáº¿n
Â  Â  Â  Â  if obj:IsA("GuiObject") and (obj.Name:lower():find("bar") or obj.Name:lower():find("cooldown")) and obj.Parent.Name:lower():find("frame") then
Â  Â  Â  Â  Â  Â  return obj
Â  Â  Â  Â  end
Â  Â  end
Â  Â  return nil
end

local function checkCooldown(targetGUI)
Â  Â  if not targetGUI or currentMode == "Spam" then return end
Â  Â  
Â  Â  -- Láº¥y giÃ¡ trá»‹ thanh bar hiá»‡n táº¡i
Â  Â  local startVal = simpleReadGUI(targetGUI)
Â  Â  if not startVal then return end
Â  Â  
Â  Â  local startTime = tick()
Â  Â  local maxWait = 5
Â  Â  
Â  Â  -- Chá» cho thanh bar thay Ä‘á»•i (cho tháº¥y Haki Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t)
Â  Â  while tick() - startTime < maxWait do
Â  Â  Â  Â  local currentVal = simpleReadGUI(targetGUI)
Â  Â  Â  Â  if currentVal and math.abs(currentVal - startVal) > 0.1 then
Â  Â  Â  Â  Â  Â  -- ÄÃ£ kÃ­ch hoáº¡t, bÃ¢y giá» chá» cooldown káº¿t thÃºc
Â  Â  Â  Â  Â  Â  local cooldownStart = tick()
Â  Â  Â  Â  Â  Â  while tick() - cooldownStart < maxWait do
Â  Â  Â  Â  Â  Â  Â  Â  local checkVal = simpleReadGUI(targetGUI)
Â  Â  Â  Â  Â  Â  Â  Â  -- Cooldown káº¿t thÃºc khi thanh bar gáº§n Ä‘áº§y hoáº·c gáº§n háº¿t (tÃ¹y game)
Â  Â  Â  Â  Â  Â  Â  Â  if checkVal and (checkVal <= 0.05 or checkVal >= 0.95) then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local duration = tick() - CooldownData.lastPressTime
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  -- Ghi láº¡i máº«u thá»i gian
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if duration > 0.1 and duration < MAX_INTERVAL * 2 then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  table.insert(CooldownData.lastSamples, duration)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if #CooldownData.lastSamples > SAMPLE_WINDOW then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  table.remove(CooldownData.lastSamples, 1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  CooldownData.successCount = CooldownData.successCount + 1
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.05)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  break
Â  Â  Â  Â  end
Â  Â  Â  Â  task.wait(0.05)
Â  Â  end
end

local function getSmartInterval()
Â  Â  if #CooldownData.lastSamples == 0 then
Â  Â  Â  Â  -- Sá»­ dá»¥ng giÃ¡ trá»‹ tá»« TextBox náº¿u cÃ³, náº¿u khÃ´ng thÃ¬ dÃ¹ng DEFAULT_INTERVAL
Â  Â  Â  Â  local intervalText = HakiUIControls.IntervalBox and HakiUIControls.IntervalBox.Text or tostring(DEFAULT_INTERVAL)
Â  Â  Â  Â  return simpleInterval(intervalText)
Â  Â  end
Â  Â  local total = 0
Â  Â  for _, sample in ipairs(CooldownData.lastSamples) do
Â  Â  Â  Â  total = total + sample
Â  Â  end
Â  Â  local avg = total / #CooldownData.lastSamples
Â  Â  return simpleClamp(avg - 0.05, MIN_INTERVAL, MAX_INTERVAL)
end


-- ================================================================= --
-- PHáº¦N UI Cá»¦A HUB CHÃNH (KHÃ”NG THAY Äá»”I NHIá»€U)
-- ================================================================= --
local MAIN_W, MAIN_H = 600, 380
local Sidebar_W = 130
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FruitHubUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

local Main = Instance.new("Frame")
Main.Name = "Main"
Main.Size = UDim2.new(0, MAIN_W, 0, MAIN_H)
Main.Position = UDim2.new(0.5, -MAIN_W/2, 0.12, 0)
Main.BackgroundColor3 = Color3.fromRGB(24,24,28)
Main.BackgroundTransparency = 0.15
Main.BorderSizePixel = 0
Main.Parent = ScreenGui
Instance.new("UICorner", Main).CornerRadius = UDim.new(0,12)

local shadow = Instance.new("UIStroke", Main)
shadow.Color = Color3.fromRGB(85, 170, 255)
shadow.Thickness = 2
shadow.Transparency = 0.6

local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1,0,0,32)
TitleBar.Position = UDim2.new(0,0,0,0)
TitleBar.BackgroundColor3 = Color3.fromRGB(32,32,36)
TitleBar.BackgroundTransparency = 0.15
TitleBar.BorderSizePixel = 0
TitleBar.Parent = Main
Instance.new("UICorner", TitleBar).CornerRadius = UDim.new(0,12)

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(0.6,-10,1,0)
TitleLabel.Position = UDim2.new(0,10,0,0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "NTBA â€¢ Farm Hub (V21.2.6)" -- Cáº¬P NHáº¬T PHIÃŠN Báº¢N
TitleLabel.TextSize = 15
TitleLabel.TextColor3 = Color3.fromRGB(170, 255, 255)
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Parent = TitleBar

local AuthorLabel = Instance.new("TextLabel")
AuthorLabel.Size = UDim2.new(0.3,-10,1,0)
AuthorLabel.Position = UDim2.new(0.7,10,0,0)
AuthorLabel.BackgroundTransparency = 1
AuthorLabel.Font = Enum.Font.Gotham
AuthorLabel.Text = "Author: NTBA"
AuthorLabel.TextSize = 12
AuthorLabel.TextColor3 = Color3.fromRGB(160,160,160)
AuthorLabel.TextXAlignment = Enum.TextXAlignment.Right
AuthorLabel.Parent = TitleBar

local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0,30,0,24)
CloseBtn.Position = UDim2.new(1,-38,0,4)
CloseBtn.BackgroundColor3 = Color3.fromRGB(180,60,60)
CloseBtn.Text = "X"
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 13
CloseBtn.TextColor3 = Color3.fromRGB(255,255,255)
CloseBtn.BorderSizePixel = 0
CloseBtn.BackgroundTransparency = 0.1
Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(0,6)
CloseBtn.Parent = TitleBar
CloseBtn.MouseButton1Click:Connect(function()
Â  Â  ScreenGui:Destroy()
Â  Â  script:Destroy()
end)

do
Â  Â  local dragging = false
Â  Â  local dragStart, startPos
Â  Â  TitleBar.InputBegan:Connect(function(input)
Â  Â  Â  Â  if input.UserInputType==Enum.UserInputType.MouseButton1 then
Â  Â  Â  Â  Â  Â  dragging=true
Â  Â  Â  Â  Â  Â  dragStart=input.Position
Â  Â  Â  Â  Â  Â  startPos=Main.Position
Â  Â  Â  Â  Â  Â  input.Changed:Connect(function()
Â  Â  Â  Â  Â  Â  Â  Â  if input.UserInputState==Enum.UserInputState.End then dragging=false end
Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  end
Â  Â  end)
Â  Â  UserInputService.InputChanged:Connect(function(input)
Â  Â  Â  Â  if dragging and input.UserInputType==Enum.UserInputType.MouseMovement then
Â  Â  Â  Â  Â  Â  local delta=input.Position - dragStart
Â  Â  Â  Â  Â  Â  Main.Position=UDim2.new(startPos.X.Scale,startPos.X.Offset+delta.X,startPos.Y.Scale,startPos.Y.Offset+delta.Y)
Â  Â  Â  Â  end
Â  Â  end)
end

-- Xá»­ lÃ½ Hotkey (DÃ¹ng biáº¿n Hotkey Ä‘Ã£ Ä‘Æ°á»£c khai bÃ¡o)
UserInputService.InputBegan:Connect(function(input,gpe)
Â  Â  if not gpe and input.KeyCode == Hotkey then
Â  Â  Â  Â  HubVisible = not HubVisible
Â  Â  Â  Â  ScreenGui.Enabled = HubVisible
Â  Â  end
end)

local Sidebar = Instance.new("Frame")
Sidebar.Size = UDim2.new(0,Sidebar_W,1,-32)
Sidebar.Position = UDim2.new(0,0,0,32)
Sidebar.BackgroundColor3 = Color3.fromRGB(36,36,38)
Sidebar.BackgroundTransparency = 0.15
Sidebar.BorderSizePixel = 0
Sidebar.Parent = Main
Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0,10)

local tabs = {"AutoFarm","AutoNPC","AutoHaki","Fruit Mix","Utility","Settings"}
local tabButtons, panels = {}, {}

local SidebarLayout = Instance.new("UIListLayout", Sidebar)
SidebarLayout.Padding = UDim.new(0,6)
SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder
SidebarLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
SidebarLayout.VerticalAlignment = Enum.VerticalAlignment.Top

local Panel_X_Start = Sidebar_W + 10
local Panel_Y_Start = 32 + 10
local Panel_W = MAIN_W - Sidebar_W - 20
local Panel_H = MAIN_H - 32 - 20

for i,name in ipairs(tabs) do
Â  Â  local btn = Instance.new("TextButton")
Â  Â  btn.Size = UDim2.new(1,-10,0,32)
Â  Â  btn.BackgroundColor3 = Color3.fromRGB(44,44,46)
Â  Â  btn.BackgroundTransparency = 0.2
Â  Â  btn.BorderSizePixel = 0
Â  Â  btn.Font = Enum.Font.GothamBold
Â  Â  btn.TextSize = 13
Â  Â  btn.TextColor3 = Color3.fromRGB(220,220,220)
Â  Â  btn.Text = name
Â  Â  btn.Parent = Sidebar
Â  Â  Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)
Â  Â  btn.LayoutOrder = i
Â  Â  tabButtons[name] = btn

Â  Â  local panel = Instance.new("Frame")
Â  Â  panel.Name = name .. "Panel"
Â  Â  panel.Size = UDim2.new(0, Panel_W, 0, Panel_H)
Â  Â  panel.Position = UDim2.new(0, Panel_X_Start, 0, Panel_Y_Start)
Â  Â  panel.BackgroundTransparency = 1
Â  Â  panel.Visible = false
Â  Â  panel.Parent = Main
Â  Â  panels[name] = panel
end

panels["AutoFarm"].Visible = true
tabButtons["AutoFarm"].BackgroundColor3 = Color3.fromRGB(60,60,62)
tabButtons["AutoFarm"].BackgroundTransparency = 0.1

for name, btn in pairs(tabButtons) do
Â  Â  btn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  for k,v in pairs(tabButtons) do v.BackgroundColor3 = Color3.fromRGB(44,44,46); v.BackgroundTransparency = 0.2 end
Â  Â  Â  Â  for _,p in pairs(panels) do p.Visible = false end
Â  Â  Â  Â  btn.BackgroundColor3 = Color3.fromRGB(60,60,62)
Â  Â  Â  Â  btn.BackgroundTransparency = 0.1
Â  Â  Â  Â  panels[name].Visible = true
Â  Â  end)
end

-- ================================================================= --
-- PANEL AUTO FARM (SKILL Z,X,C,V) & NPC
-- (GIá»® NGUYÃŠN)
-- ================================================================= --

local AutoFarmPanel = panels["AutoFarm"]
do
Â  Â  local p = AutoFarmPanel
Â  Â  local y=6
Â  Â  local label=Instance.new("TextLabel",p)
Â  Â  label.Size=UDim2.new(1,0,0,24)
Â  Â  label.Position=UDim2.new(0,0,0,y)
Â  Â  label.BackgroundTransparency = 1
Â  Â  label.Font = Enum.Font.GothamBold
Â  Â  label.TextSize = 14
Â  Â  label.TextColor3 = Color3.fromRGB(220,220,220)
Â  Â  label.Text="Auto Skills (spam keys)"
Â  Â  y=y+30

Â  Â  local x_start = 10
Â  Â  local spacing = (Panel_W - (100 * 4 + x_start * 2)) / 3

Â  Â  for i,key in ipairs({"Z","X","C","V"}) do
Â  Â  Â  Â  local btn=Instance.new("TextButton",p)
Â  Â  Â  Â  btn.Size=UDim2.new(0,100,0,32)
Â  Â  Â  Â  btn.Position=UDim2.new(0,x_start+(i-1)*(100+spacing),0,y)
Â  Â  Â  Â  btn.Text=key.." OFF"
Â  Â  Â  Â  btn.Font = Enum.Font.GothamBold
Â  Â  Â  Â  btn.TextSize = 14
Â  Â  Â  Â  btn.TextColor3 = Color3.fromRGB(230,230,230)
Â  Â  Â  Â  btn.BackgroundColor3 = Color3.fromRGB(60,60,62)
Â  Â  Â  Â  btn.BackgroundTransparency = 0.15
Â  Â  Â  Â  btn.BorderSizePixel = 0
Â  Â  Â  Â  Instance.new("UICorner",btn).CornerRadius = UDim.new(0,6)
Â  Â  Â  Â  local state=false
Â  Â  Â  Â  btn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  Â  Â  state=not state
Â  Â  Â  Â  Â  Â  AutoSkillState[key]=state
Â  Â  Â  Â  Â  Â  btn.Text=key..(state and " ON" or " OFF")
Â  Â  Â  Â  Â  Â  btn.BackgroundColor3=state and Color3.fromRGB(0,170,255) or Color3.fromRGB(60,60,62)
Â  Â  Â  Â  Â  Â  btn.BackgroundTransparency=state and 0.1 or 0.15
Â  Â  Â  Â  end)
Â  Â  end
end

-- VÃ’NG Láº¶P AUTO SKILL
task.spawn(function()
Â  Â  while true do
Â  Â  Â  Â  task.wait(0.5)
Â  Â  Â  Â  if not AutoFarmNPC then
Â  Â  Â  Â  Â  Â  for key,enabled in pairs(AutoSkillState) do
Â  Â  Â  Â  Â  Â  Â  Â  if enabled then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(true,key,false,game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.04)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(false,key,false,game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  end
Â  Â  end
end)

local AutoNPCPanel = panels["AutoNPC"]
do
Â  Â  local p = AutoNPCPanel
Â  Â  local y = 6
Â  Â  local label = Instance.new("TextLabel", p)
Â  Â  label.Size = UDim2.new(1, 0, 0, y)
Â  Â  label.Position = UDim2.new(0, 0, 0, y)
Â  Â  label.BackgroundTransparency = 1
Â  Â  label.Font = Enum.Font.GothamBold
Â  Â  label.TextSize = 14
Â  Â  label.TextColor3 = Color3.fromRGB(255, 170, 0)
Â  Â  label.Text = "AUTO FARM NPC (Tá»± Ä‘á»™ng Ä‘Ã¡nh quÃ¡i)"
Â  Â  y = y + 30

Â  Â  local masterBtn = Instance.new("TextButton", p)
Â  Â  masterBtn.Size = UDim2.new(0, 200, 0, 32)
Â  Â  masterBtn.Position = UDim2.new(0, 10, 0, y)
Â  Â  masterBtn.Text = "Auto Farm NPC: OFF"
Â  Â  masterBtn.Font = Enum.Font.GothamBold
Â  Â  masterBtn.TextSize = 14
Â  Â  masterBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  masterBtn.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
Â  Â  masterBtn.BackgroundTransparency = 0.15
Â  Â  masterBtn.BorderSizePixel = 0
Â  Â  Instance.new("UICorner", masterBtn).CornerRadius = UDim.new(0, 6)

Â  Â  masterBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  AutoFarmNPC = not AutoFarmNPC
Â  Â  Â  Â  masterBtn.Text = "Auto Farm NPC: " .. (AutoFarmNPC and "ON" or "OFF")
Â  Â  Â  Â  masterBtn.BackgroundColor3 = AutoFarmNPC and Color3.fromRGB(0, 150, 255) or Color3.fromRGB(150, 50, 50)
Â  Â  Â  Â  masterBtn.BackgroundTransparency = AutoFarmNPC and 0.1 or 0.15
Â  Â  end)
Â  Â  y = y + 42

Â  Â  local lblRange = Instance.new("TextLabel", p)
Â  Â  lblRange.Size = UDim2.new(0, 250, 0, 18)
Â  Â  lblRange.Position = UDim2.new(0, 10, 0, y)
Â  Â  lblRange.BackgroundTransparency = 1
Â  Â  lblRange.Font = Enum.Font.Gotham
Â  Â  lblRange.TextSize = 12
Â  Â  lblRange.TextColor3 = Color3.fromRGB(200, 200, 200)
Â  Â  lblRange.Text = "Pháº¡m vi tÃ¬m kiáº¿m: " .. FarmRadius .. " studs (Máº·c Ä‘á»‹nh)"
Â  Â  lblRange.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  y = y + 24

Â  Â  local btnInfo = Instance.new("TextLabel", p)
Â  Â  btnInfo.Size = UDim2.new(1, -20, 0, 40)
Â  Â  btnInfo.Position = UDim2.new(0, 10, 0, y)
Â  Â  btnInfo.BackgroundTransparency = 1
Â  Â  btnInfo.Font = Enum.Font.GothamBold
Â  Â  btnInfo.TextSize = 12
Â  Â  btnInfo.TextColor3 = Color3.fromRGB(255, 170, 170)
Â  Â  btnInfo.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  btnInfo.Text = "Cáº¦N LÃ€M: Báº¬T Auto Skills (Z, X, C, V) trong tab AutoFarm Ä‘á»ƒ sá»­ dá»¥ng chiÃªu!"
Â  Â  y = y + 50
end

local function findAndFarmNPC()
Â  Â  local targetNPC = nil
Â  Â  local shortestDistance = FarmRadius + 1

Â  Â  for _, v in ipairs(workspace:GetChildren()) do
Â  Â  Â  Â  if v:IsA("Model") and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
Â  Â  Â  Â  Â  Â  if v.Name ~= player.Name then
Â  Â  Â  Â  Â  Â  Â  Â  local npcHR = v:FindFirstChild("HumanoidRootPart")
Â  Â  Â  Â  Â  Â  Â  Â  if npcHR and hrp then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local distance = (hrp.Position - npcHR.Position).Magnitude
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if distance < shortestDistance then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  shortestDistance = distance
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  targetNPC = npcHR
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  end
Â  Â  end

Â  Â  if targetNPC then
Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  local direction = (hrp.Position - targetNPC.Position).Unit
Â  Â  Â  Â  Â  Â  hrp.CFrame = targetNPC.CFrame * CFrame.new(0, 0, -10)
Â  Â  Â  Â  end)

Â  Â  Â  Â  for i = 1, 3 do
Â  Â  Â  Â  Â  Â  for key, enabled in pairs(AutoSkillState) do
Â  Â  Â  Â  Â  Â  Â  Â  if enabled then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(true, key, false, game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.04)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(false, key, false, game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  task.wait(0.3)
Â  Â  Â  Â  end
Â  Â  Â  Â  return true
Â  Â  end
Â  Â  return false
end

task.spawn(function()
Â  Â  while true do
Â  Â  Â  Â  if AutoFarmNPC and hrp and hrp.Parent and hrp.Parent:FindFirstChildOfClass("Humanoid").Health > 0 then
Â  Â  Â  Â  Â  Â  findAndFarmNPC()
Â  Â  Â  Â  end
Â  Â  Â  Â  task.wait(0.5)
Â  Â  end
end)

-- VÃ’NG Láº¶P GOD MODE
RunService.Heartbeat:Connect(function(step)
Â  Â  if GodModeState and player.Character then
Â  Â  Â  Â  local human = player.Character:FindFirstChildOfClass("Humanoid")
Â  Â  Â  Â  if human and human.Health > 0 and human.MaxHealth > 0 then
Â  Â  Â  Â  Â  Â  human.Health = human.MaxHealth
Â  Â  Â  Â  end
Â  Â  end
end)


-- ================================================================= --
-- PANEL AUTO HAKI (ÄÃƒ Sá»¬A Lá»–I UI)
-- ================================================================= --
local AutoHakiPanel = panels["AutoHaki"]
local targetGUI = nil

do
Â  Â  local p = AutoHakiPanel
Â  Â  p.BackgroundTransparency = 0.95
Â  Â  local y = 6

Â  Â  local title = Instance.new("TextLabel")
Â  Â  title.Size = UDim2.new(1, 0, 0, 25)
Â  Â  title.Position = UDim2.new(0, 0, 0, y)
Â  Â  title.BackgroundTransparency = 1
Â  Â  title.Text = "AutoHaki ADAPTIVE/SPAM (R & Q)"
Â  Â  title.TextColor3 = Color3.fromRGB(0, 255, 0)
Â  Â  title.Font = Enum.Font.SourceSansBold
Â  Â  title.TextSize = 16
Â  Â  title.Parent = p
Â  Â  y = y + 25

Â  Â  local status = Instance.new("TextLabel")
Â  Â  status.Name = "StatusLabel"
Â  Â  status.Size = UDim2.new(1, -10, 0, 20)
Â  Â  status.Position = UDim2.new(0, 5, 0, y)
Â  Â  status.BackgroundTransparency = 1
Â  Â  status.Text = "ğŸ”´ R OFF | ğŸ”´ Q OFF | Mode: Adaptive | Success: 0%"
Â  Â  status.TextColor3 = Color3.fromRGB(200, 200, 200)
Â  Â  status.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  status.Font = Enum.Font.SourceSans
Â  Â  status.TextSize = 14
Â  Â  status.Parent = p
Â  Â  HakiUIControls.StatusLabel = status
Â  Â  y = y + 25

Â  Â  -- HÃ€M Cáº¬P NHáº¬T UI
Â  Â  local function updateUI()
Â  Â  Â  Â  local successRate = CooldownData.pressCount > 0 and
Â  Â  Â  Â  Â  Â  math.floor((CooldownData.successCount / CooldownData.pressCount) * 100) or 0
Â  Â  Â  Â  
Â  Â  Â  Â  status.Text = string.format("%s R | %s Q | Mode: %s | Success: %d%%",
Â  Â  Â  Â  Â  Â  isRunningR and "ğŸŸ¢" or "ğŸ”´",
Â  Â  Â  Â  Â  Â  isRunningQ and "ğŸŸ¢" or "ğŸ”´",
Â  Â  Â  Â  Â  Â  currentMode,
Â  Â  Â  Â  Â  Â  successRate
Â  Â  Â  Â  )
Â  Â  end
Â  Â  HakiUIControls.UpdateFunction = updateUI

Â  Â  local modeBtn = Instance.new("TextButton")
Â  Â  modeBtn.Size = UDim2.new(0, 80, 0, 25)
Â  Â  modeBtn.Position = UDim2.new(0, 5, 0, y)
Â  Â  modeBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 120)
Â  Â  modeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  modeBtn.Text = "Adaptive"
Â  Â  modeBtn.Font = Enum.Font.SourceSans
Â  Â  modeBtn.TextSize = 14
Â  Â  modeBtn.Parent = p
Â  Â  HakiUIControls.ModeButton = modeBtn

Â  Â  local intBox = Instance.new("TextBox")
Â  Â  intBox.Name = "IntervalBox"
Â  Â  intBox.Size = UDim2.new(0, 60, 0, 25)
Â  Â  intBox.Position = UDim2.new(0, 90, 0, y)
Â  Â  intBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Â  Â  intBox.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  intBox.Text = string.format("%.2f", DEFAULT_INTERVAL)
Â  Â  intBox.ClearTextOnFocus = false
Â  Â  intBox.Font = Enum.Font.SourceSans
Â  Â  intBox.TextSize = 14
Â  Â  intBox.Parent = p
Â  Â  HakiUIControls.IntervalBox = intBox

Â  Â  local rToggleBtn = Instance.new("TextButton")
Â  Â  rToggleBtn.Size = UDim2.new(0, 100, 0, 25)
Â  Â  rToggleBtn.Position = UDim2.new(1, -105, 0, y)
Â  Â  rToggleBtn.AnchorPoint = Vector2.new(1, 0)
Â  Â  rToggleBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
Â  Â  rToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  rToggleBtn.Text = "R START (F6)"
Â  Â  rToggleBtn.Font = Enum.Font.SourceSansBold
Â  Â  rToggleBtn.TextSize = 14
Â  Â  rToggleBtn.Parent = p
Â  Â  HakiUIControls.RToggleButton = rToggleBtn
Â  Â  y = y + 30

Â  Â  local pathBox = Instance.new("TextBox")
Â  Â  pathBox.Name = "PathBox"
Â  Â  pathBox.Size = UDim2.new(1, -10, 0, 20)
Â  Â  pathBox.Position = UDim2.new(0, 5, 0, y)
Â  Â  pathBox.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Â  Â  pathBox.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  pathBox.PlaceholderText = "Auto-detecting GUI..."
Â  Â  pathBox.ClearTextOnFocus = false
Â  Â  pathBox.Font = Enum.Font.SourceSans
Â  Â  pathBox.TextSize = 12
Â  Â  pathBox.Parent = p
Â  Â  HakiUIControls.PathBox = pathBox
Â  Â  y = y + 25

Â  Â  local qToggleBtn = Instance.new("TextButton")
Â  Â  qToggleBtn.Name = "QToggleBtn"
Â  Â  qToggleBtn.Size = UDim2.new(0, 120, 0, 25)
Â  Â  qToggleBtn.Position = UDim2.new(0, 5, 0, y)
Â  Â  qToggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
Â  Â  qToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  qToggleBtn.Text = "ğŸ”´ Auto Q: OFF"
Â  Â  qToggleBtn.Font = Enum.Font.SourceSansBold
Â  Â  qToggleBtn.TextSize = 14
Â  Â  qToggleBtn.Parent = p
Â  Â  HakiUIControls.QToggleButton = qToggleBtn
Â  Â  y = y + 30

Â  Â  local infoLabel = Instance.new("TextLabel")
Â  Â  infoLabel.Name = "InfoLabel"
Â  Â  infoLabel.Size = UDim2.new(1, -10, 0, 40)
Â  Â  infoLabel.Position = UDim2.new(0, 5, 0, y)
Â  Â  infoLabel.BackgroundTransparency = 1
Â  Â  infoLabel.Text = "Ready... Press R START. Mode: Adaptive"
Â  Â  infoLabel.TextColor3 = Color3.fromRGB(150, 150, 255)
Â  Â  infoLabel.TextSize = 12
Â  Â  infoLabel.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  infoLabel.TextYAlignment = Enum.TextYAlignment.Top
Â  Â  infoLabel.TextWrap = true
Â  Â  infoLabel.Parent = p
Â  Â  HakiUIControls.InfoLabel = infoLabel
Â  Â  
Â  Â  -- CONNECT ACTIONS
Â  Â  
Â  Â  -- Toggle R
Â  Â  rToggleBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  isRunningR = not isRunningR
Â  Â  Â  Â  rToggleBtn.Text = isRunningR and "R STOP (F6)" or "R START (F6)"
Â  Â  Â  Â  rToggleBtn.BackgroundColor3 = isRunningR and Color3.fromRGB(0, 180, 0) or Color3.fromRGB(200, 0, 0)
Â  Â  Â  Â  infoLabel.Text = isRunningR and "R Running. Monitoring cooldown patterns" or "R Stopped. Ready to continue."
Â  Â  Â  Â  updateUI()
Â  Â  end)

Â  Â  -- Hotkey F6
Â  Â  UserInputService.InputBegan:Connect(function(input, gpe)
Â  Â  Â  Â  if not gpe and input.KeyCode == Enum.KeyCode.F6 and panels["AutoHaki"].Visible then
Â  Â  Â  Â  Â  Â  rToggleBtn.MouseButton1Click:Fire()
Â  Â  Â  Â  end
Â  Â  end)

Â  Â  -- Toggle Q
Â  Â  qToggleBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  isRunningQ = not isRunningQ
Â  Â  Â  Â  qToggleBtn.Text = isRunningQ and "ğŸŸ¢ Auto Q: ON" or "ğŸ”´ Auto Q: OFF"
Â  Â  Â  Â  qToggleBtn.BackgroundColor3 = isRunningQ and Color3.fromRGB(0, 120, 0) or Color3.fromRGB(80, 80, 80)
Â  Â  Â  Â  infoLabel.Text = isRunningQ and "Auto Q: ON. Báº¥m R vÃ  Q cÃ¹ng nhau (Tá»‘t cho cÃ¡c game cÃ³ 2 Haki)." or "Auto Q: OFF. Chá»‰ báº¥m R."
Â  Â  Â  Â  updateUI()
Â  Â  end)

Â  Â  -- Toggle Mode
Â  Â  modeBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  currentMode = (currentMode == "Adaptive") and "Spam" or "Adaptive"
Â  Â  Â  Â  modeBtn.Text = currentMode
Â  Â  Â  Â  modeBtn.BackgroundColor3 = currentMode == "Adaptive" and Color3.fromRGB(60, 60, 120) or Color3.fromRGB(120, 60, 60)
Â  Â  Â  Â  infoLabel.Text = currentMode == "Adaptive" and "Mode: Adaptive (Tá»± Ä‘á»™ng canh cooldown)." or "Mode: Spam (Báº¥m liÃªn tá»¥c theo Interval)."
Â  Â  Â  Â  updateUI()
Â  Â  end)

Â  Â  -- Auto-detect GUI khi panel hiá»‡n
Â  Â  task.spawn(function()
Â  Â  Â  Â  task.wait(3)
Â  Â  Â  Â  local gui = simpleFindGUI()
Â  Â  Â  Â  if gui then
Â  Â  Â  Â  Â  Â  targetGUI = gui
Â  Â  Â  Â  Â  Â  pathBox.Text = gui:GetFullName()
Â  Â  Â  Â  Â  Â  infoLabel.Text = "Auto-detected: " .. gui.Name
Â  Â  Â  Â  end
Â  Â  end)
end

-- ================================================================= --
-- VÃ’NG Láº¶P CHÃNH AUTO HAKI (ADAPTIVE/SPAM)
-- ================================================================= --

local mainLoopActive = true
local loopCount = 0

task.spawn(function()
Â  Â  while mainLoopActive do
Â  Â  Â  Â  if isRunningR then
Â  Â  Â  Â  Â  Â  loopCount = loopCount + 1
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  CooldownData.pressCount = CooldownData.pressCount + 1
Â  Â  Â  Â  Â  Â  CooldownData.lastPressTime = tick()
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- Nháº¥n phÃ­m R
Â  Â  Â  Â  Â  Â  pcall(doKeyTap, DEFAULT_KEY)
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- Nháº¥n phÃ­m Q náº¿u Ä‘Æ°á»£c báº­t riÃªng biá»‡t
Â  Â  Â  Â  Â  Â  if isRunningQ then
Â  Â  Â  Â  Â  Â  Â  Â  pcall(doKeyTap, SECONDARY_KEY)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- TÃ¬m/Kiá»ƒm tra GUI
Â  Â  Â  Â  Â  Â  if not targetGUI then
Â  Â  Â  Â  Â  Â  Â  Â  targetGUI = simpleFindGUI()
Â  Â  Â  Â  Â  Â  Â  Â  if targetGUI and HakiUIControls.PathBox then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  HakiUIControls.PathBox.Text = targetGUI:GetFullName()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  HakiUIControls.InfoLabel.Text = "Auto-detected: " .. targetGUI.Name
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end

Â  Â  Â  Â  Â  Â  if targetGUI then
Â  Â  Â  Â  Â  Â  Â  Â  checkCooldown(targetGUI)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- Cáº­p nháº­t interval vÃ  UI
Â  Â  Â  Â  Â  Â  local waitTime = 0.5 -- Default khi ko cÃ³ TextBox
Â  Â  Â  Â  Â  Â  if HakiUIControls.IntervalBox then
Â  Â  Â  Â  Â  Â  Â  Â  waitTime = simpleInterval(HakiUIControls.IntervalBox.Text)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if currentMode == "Adaptive" then
Â  Â  Â  Â  Â  Â  Â  Â  waitTime = getSmartInterval()
Â  Â  Â  Â  Â  Â  end

Â  Â  Â  Â  Â  Â  if loopCount % 5 == 0 and HakiUIControls.UpdateFunction then
Â  Â  Â  Â  Â  Â  Â  Â  HakiUIControls.UpdateFunction()
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  task.wait(waitTime)
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  task.wait(0.5)
Â  Â  Â  Â  end
Â  Â  end
end)

-- ================================================================= --
-- CÃC PANEL KHÃC VÃ€ CLEANUP (GIá»® NGUYÃŠN)
-- ================================================================= --

local FruitMixPanel = panels["Fruit Mix"]
do
Â  Â  local p = FruitMixPanel
Â  Â  local y = 6
Â  Â  local label = Instance.new("TextLabel", p)
Â  Â  label.Size = UDim2.new(1, 0, 0, y)
Â  Â  label.Position = UDim2.new(0, 0, 0, y)
Â  Â  label.BackgroundTransparency = 1
Â  Â  label.Font = Enum.Font.GothamBold
Â  Â  label.TextSize = 14
Â  Â  label.TextColor3 = Color3.fromRGB(0, 255, 170)
Â  Â  label.Text = "AUTO DROP ITEMS (FRUIT MIX)"
Â  Â  y = y + 30

Â  Â  -- NÃšT AUTO DROP ITEM THÆ¯á»œNG
Â  Â  local dropBtn = Instance.new("TextButton", p)
Â  Â  dropBtn.Size = UDim2.new(0, 280, 0, 32)
Â  Â  dropBtn.Position = UDim2.new(0, 10, 0, y)
Â  Â  dropBtn.Text = "Auto Drop Item (ThÆ°á»ng): OFF"
Â  Â  dropBtn.Font = Enum.Font.GothamBold
Â  Â  dropBtn.TextSize = 14
Â  Â  dropBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  dropBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 150)
Â  Â  dropBtn.BackgroundTransparency = 0.15
Â  Â  dropBtn.BorderSizePixel = 0
Â  Â  Instance.new("UICorner", dropBtn).CornerRadius = UDim.new(0, 6)

Â  Â  dropBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  AutoDropItem = not AutoDropItem
Â  Â  Â  Â  dropBtn.Text = "Auto Drop Item (ThÆ°á»ng): " .. (AutoDropItem and "ON" or "OFF")
Â  Â  Â  Â  dropBtn.BackgroundColor3 = AutoDropItem and Color3.fromRGB(0, 170, 255) or Color3.fromRGB(50, 50, 150)
Â  Â  Â  Â  dropBtn.BackgroundTransparency = AutoDropItem and 0.1 or 0.15
Â  Â  end)
Â  Â  y = y + 40

Â  Â  -- NÃšT AUTO DROP ITEM PLUS (+)
Â  Â  local dropPlusBtn = Instance.new("TextButton", p)
Â  Â  dropPlusBtn.Size = UDim2.new(0, 280, 0, 32)
Â  Â  dropPlusBtn.Position = UDim2.new(0, 10, 0, y)
Â  Â  dropPlusBtn.Text = "Auto Drop Item (+): OFF"
Â  Â  dropPlusBtn.Font = Enum.Font.GothamBold
Â  Â  dropPlusBtn.TextSize = 14
Â  Â  dropPlusBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  dropPlusBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 150)
Â  Â  dropPlusBtn.BackgroundTransparency = 0.15
Â  Â  dropPlusBtn.BorderSizePixel = 0
Â  Â  Instance.new("UICorner", dropPlusBtn).CornerRadius = UDim.new(0, 6)

Â  Â  dropPlusBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  AutoDropItemPlus = not AutoDropItemPlus
Â  Â  Â  Â  dropPlusBtn.Text = "Auto Drop Item (+): " .. (AutoDropItemPlus and "ON" or "OFF")
Â  Â  Â  Â  dropPlusBtn.BackgroundColor3 = AutoDropItemPlus and Color3.fromRGB(0, 200, 150) or Color3.fromRGB(50, 150, 150)
Â  Â  Â  Â  dropPlusBtn.BackgroundTransparency = AutoDropItemPlus and 0.1 or 0.15
Â  Â  end)
Â  Â  y = y + 42

Â  Â  -- NÃšT AUTO FRUIT MIX (COLLECT CHEST)
Â  Â  local collectBtn = Instance.new("TextButton", p)
Â  Â  collectBtn.Size = UDim2.new(0, 280, 0, 32)
Â  Â  collectBtn.Position = UDim2.new(0, 10, 0, y)
Â  Â  collectBtn.Text = "Auto Fruit Mix (Loot Chests): OFF"
Â  Â  collectBtn.Font = Enum.Font.GothamBold
Â  Â  collectBtn.TextSize = 13
Â  Â  collectBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  collectBtn.BackgroundColor3 = Color3.fromRGB(150, 150, 50)
Â  Â  collectBtn.BackgroundTransparency = 0.15
Â  Â  collectBtn.BorderSizePixel = 0
Â  Â  Instance.new("UICorner", collectBtn).CornerRadius = UDim.new(0, 6)

Â  Â  collectBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  AutoCollectChestState = not AutoCollectChestState
Â  Â  Â  Â  collectBtn.Text = "Auto Fruit Mix (Loot Chests): " .. (AutoCollectChestState and "ON" or "OFF")
Â  Â  Â  Â  collectBtn.BackgroundColor3 = AutoCollectChestState and Color3.fromRGB(255, 170, 0) or Color3.fromRGB(150, 150, 50)
Â  Â  Â  Â  collectBtn.BackgroundTransparency = AutoCollectChestState and 0.1 or 0.15
Â  Â  end)
Â  Â  y = y + 42

Â  Â  -- PHáº M VI TÃ™Y CHá»ˆNH
Â  Â  local radiusLabel = Instance.new("TextLabel", p)
Â  Â  radiusLabel.Size = UDim2.new(0, 180, 0, 24)
Â  Â  radiusLabel.Position = UDim2.new(0, 10, 0, y)
Â  Â  radiusLabel.BackgroundTransparency = 1
Â  Â  radiusLabel.Font = Enum.Font.Gotham
Â  Â  radiusLabel.TextSize = 12
Â  Â  radiusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
Â  Â  radiusLabel.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  local function updateRadiusLabel()
Â  Â  Â  Â  radiusLabel.Text = "Pháº¡m vi Loot Rada (100-350): " .. CollectChestRadius
Â  Â  end
Â  Â  updateRadiusLabel()
Â  Â  y = y + 28

Â  Â  local radiusInput = Instance.new("TextBox", p)
Â  Â  radiusInput.Size = UDim2.new(0, 80, 0, 32)
Â  Â  radiusInput.Position = UDim2.new(0, 10, 0, y)
Â  Â  radiusInput.PlaceholderText = "100-350"
Â  Â  radiusInput.Text = tostring(CollectChestRadius)
Â  Â  radiusInput.Font = Enum.Font.Gotham
Â  Â  radiusInput.TextSize = 14
Â  Â  radiusInput.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  radiusInput.BackgroundColor3 = Color3.fromRGB(40, 40, 44)
Â  Â  radiusInput.BackgroundTransparency = 0.15
Â  Â  radiusInput.TextXAlignment = Enum.TextXAlignment.Center
Â  Â  Instance.new("UICorner", radiusInput).CornerRadius = UDim.new(0, 6)

Â  Â  local setRadiusBtn = Instance.new("TextButton", p)
Â  Â  setRadiusBtn.Size = UDim2.new(0, 100, 0, 32)
Â  Â  setRadiusBtn.Position = UDim2.new(0, 100, 0, y)
Â  Â  setRadiusBtn.Text = "SET"
Â  Â  setRadiusBtn.Font = Enum.Font.GothamBold
Â  Â  setRadiusBtn.TextSize = 14
Â  Â  setRadiusBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  setRadiusBtn.BackgroundColor3 = Color3.fromRGB(80, 150, 80)
Â  Â  setRadiusBtn.BackgroundTransparency = 0.15
Â  Â  Instance.new("UICorner", setRadiusBtn).CornerRadius = UDim.new(0, 6)

Â  Â  setRadiusBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  local newRadius = tonumber(radiusInput.Text)
Â  Â  Â  Â  if newRadius and newRadius >= 100 and newRadius <= 350 then
Â  Â  Â  Â  Â  Â  CollectChestRadius = newRadius
Â  Â  Â  Â  Â  Â  updateRadiusLabel()
Â  Â  Â  Â  Â  Â  radiusInput.Text = tostring(CollectChestRadius)
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  radiusInput.Text = "Lá»–I! 100-350"
Â  Â  Â  Â  Â  Â  task.wait(1)
Â  Â  Â  Â  Â  Â  radiusInput.Text = tostring(CollectChestRadius)
Â  Â  Â  Â  end
Â  Â  end)
Â  Â  y = y + 42

Â  Â  local note = Instance.new("TextLabel", p)
Â  Â  note.Size = UDim2.new(1, -20, 0, 40)
Â  Â  note.Position = UDim2.new(0, 10, 0, y)
Â  Â  note.BackgroundTransparency = 1
Â  Â  note.Font = Enum.Font.Gotham
Â  Â  note.TextSize = 12
Â  Â  note.TextColor3 = Color3.fromRGB(255, 170, 170)
Â  Â  note.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  note.TextWrap = true
Â  Â  note.Text = string.format("Auto Fruit Mix: TÃ¬m Model '%s', Teleport & click Part '%s'. Pháº¡m vi Rada Ä‘i theo nhÃ¢n váº­t.", CHEST_MODEL_NAME, CLICKABLE_PART_NAME)
end


local UtilityPanel = panels["Utility"]
do
Â  Â  local p = UtilityPanel
Â  Â  local y = 6
Â  Â  local label = Instance.new("TextLabel", p)
Â  Â  label.Size = UDim2.new(1, 0, 0, y)
Â  Â  label.Position = UDim2.new(0, 0, 0, y)
Â  Â  label.BackgroundTransparency = 1
Â  Â  label.Font = Enum.Font.GothamBold
Â  Â  label.TextSize = 14
Â  Â  label.TextColor3 = Color3.fromRGB(85, 170, 255)
Â  Â  label.Text = "CHá»¨C NÄ‚NG TIá»†N ÃCH KHÃC"
Â  Â  y = y + 30

Â  Â  -- NÃšT GOD MODE
Â  Â  local godModeBtn = Instance.new("TextButton", p)
Â  Â  godModeBtn.Size = UDim2.new(0, 240, 0, 32)
Â  Â  godModeBtn.Position = UDim2.new(0, 10, 0, y)
Â  Â  godModeBtn.Text = "God Mode (Báº¥t Tá»­): OFF"
Â  Â  godModeBtn.Font = Enum.Font.GothamBold
Â  Â  godModeBtn.TextSize = 13
Â  Â  godModeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  godModeBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 50)
Â  Â  godModeBtn.BackgroundTransparency = 0.15
Â  Â  godModeBtn.BorderSizePixel = 0
Â  Â  Instance.new("UICorner", godModeBtn).CornerRadius = UDim.new(0, 6)

Â  Â  godModeBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  GodModeState = not GodModeState
Â  Â  Â  Â  godModeBtn.Text = "God Mode (Báº¥t Tá»­): " .. (GodModeState and "ON" or "OFF")
Â  Â  Â  Â  godModeBtn.BackgroundColor3 = GodModeState and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(0, 150, 50)
Â  Â  Â  Â  godModeBtn.BackgroundTransparency = GodModeState and 0.1 or 0.15
Â  Â  end)
Â  Â  y = y + 42
end


local SettingsPanel = panels["Settings"]
do
Â  Â  local p = SettingsPanel
Â  Â  local y = 6
Â  Â  local label = Instance.new("TextLabel", p)
Â  Â  label.Size = UDim2.new(1, 0, 0, 24)
Â  Â  label.Position = UDim2.new(0, 0, 0, y)
Â  Â  label.BackgroundTransparency = 1
Â  Â  label.Font = Enum.Font.GothamBold
Â  Â  label.TextSize = 14
Â  Â  label.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  label.Text = "TÃ™Y CHá»ˆNH NÃšT áº¨N/HIá»†N HUB"
Â  Â  y = y + 30

Â  Â  -- Label hiá»ƒn thá»‹ nÃºt hiá»‡n táº¡i
Â  Â  local keyLabel = Instance.new("TextLabel", p)
Â  Â  keyLabel.Name = "KeyLabel"
Â  Â  keyLabel.Size = UDim2.new(0, 180, 0, 24)
Â  Â  keyLabel.Position = UDim2.new(0, 10, 0, y)
Â  Â  keyLabel.BackgroundTransparency = 1
Â  Â  local function updateKeyLabel()
Â  Â  Â  Â  keyLabel.Text = "NÃºt hiá»‡n táº¡i: " .. tostring(Hotkey.Name)
Â  Â  end
Â  Â  updateKeyLabel()
Â  Â  y = y + 28

Â  Â  -- Textbox Ä‘á»ƒ nháº­p phÃ­m má»›i
Â  Â  local keyInput = Instance.new("TextBox", p)
Â  Â  keyInput.Size = UDim2.new(0, 180, 0, 32)
Â  Â  keyInput.Position = UDim2.new(0, 10, 0, y)
Â  Â  keyInput.PlaceholderText = "Nháº­p phÃ­m má»›i (VÃ­ dá»¥: F2)"
Â  Â  keyInput.Text = ""
Â  Â  keyInput.Font = Enum.Font.Gotham
Â  Â  keyInput.TextSize = 14
Â  Â  keyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  keyInput.BackgroundColor3 = Color3.fromRGB(40, 40, 44)
Â  Â  keyInput.BackgroundTransparency = 0.15
Â  Â  keyInput.TextXAlignment = Enum.TextXAlignment.Center
Â  Â  Instance.new("UICorner", keyInput).CornerRadius = UDim.new(0, 6)
Â  Â  y = y + 42

Â  Â  -- NÃºt lÆ°u
Â  Â  local saveBtn = Instance.new("TextButton", p)
Â  Â  saveBtn.Size = UDim2.new(0, 100, 0, 32)
Â  Â  saveBtn.Position = UDim2.new(0, 200, 0, y - 32)
Â  Â  saveBtn.Text = "LÆ¯U PHÃM"
Â  Â  saveBtn.Font = Enum.Font.GothamBold
Â  Â  saveBtn.TextSize = 14
Â  Â  saveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
Â  Â  saveBtn.BackgroundColor3 = Color3.fromRGB(80, 150, 80)
Â  Â  saveBtn.BackgroundTransparency = 0.15
Â  Â  Instance.new("UICorner", saveBtn).CornerRadius = UDim.new(0, 6)

Â  Â  saveBtn.MouseButton1Click:Connect(function()
Â  Â  Â  Â  local newKeyName = keyInput.Text:upper()
Â  Â  Â  Â  local success, newKey = pcall(function() return Enum.KeyCode[newKeyName] end)

Â  Â  Â  Â  if success and newKey then
Â  Â  Â  Â  Â  Â  Hotkey = newKey
Â  Â  Â  Â  Â  Â  updateKeyLabel()
Â  Â  Â  Â  Â  Â  keyInput.Text = ""
Â  Â  Â  Â  Â  Â  print("Hotkey Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i thÃ nh: " .. tostring(Hotkey.Name))
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  keyInput.Text = "PhÃ­m khÃ´ng há»£p lá»‡!"
Â  Â  Â  Â  Â  Â  warn("KhÃ´ng thá»ƒ thay Ä‘á»•i Hotkey: PhÃ­m khÃ´ng há»£p lá»‡.")
Â  Â  Â  Â  Â  Â  task.wait(1)
Â  Â  Â  Â  Â  Â  keyInput.Text = ""
Â  Â  Â  Â  end
Â  Â  end)
Â  Â  y = y + 50

Â  Â  local note = Instance.new("TextLabel", p)
Â  Â  note.Size = UDim2.new(1, -20, 0, 40)
Â  Â  note.Position = UDim2.new(0, 10, 0, y)
Â  Â  note.BackgroundTransparency = 1
Â  Â  note.Font = Enum.Font.Gotham
Â  Â  note.TextSize = 12
Â  Â  note.TextColor3 = Color3.fromRGB(255, 170, 170)
Â  Â  note.TextXAlignment = Enum.TextXAlignment.Left
Â  Â  note.TextWrap = true
Â  Â  note.Text = "Chá»‰ dÃ¹ng phÃ­m Ä‘Æ¡n (vÃ­ dá»¥: F2, R, P, LeftControl, RightControl, E...)."
Â  Â  y = y + 50
end

-- VÃ’NG Láº¶P AUTO DROP ITEM THÆ¯á»œNG
task.spawn(function()
Â  Â  while true do
Â  Â  Â  Â  if AutoDropItem then
Â  Â  Â  Â  Â  Â  local itemToDrop = findDroppableItemInList(ITEM_DROP_LIST)

Â  Â  Â  Â  Â  Â  if itemToDrop then
Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  itemToDrop.Parent = Character
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.01)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Backspace, false, game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.01)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Backspace, false, game)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.1)
Â  Â  Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  end
Â  Â  Â  Â  task.wait(0.1)
Â  Â  end
end)

-- VÃ’NG Láº¶P AUTO DROP ITEM PLUS (+)
task.spawn(function()
Â  Â  while true do
Â  Â  Â  Â  if AutoDropItemPlus then
Â  Â  Â  Â  Â  Â  local itemToDrop = findDroppableItemInList(ITEM_DROP_PLUS_LIST)

Â  Â  Â  Â  Â  Â  if itemToDrop then
Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  itemToDrop.Parent = Character
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.01)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Backspace, false, game)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.01)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Backspace, false, game)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.1)
Â  Â  Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  end
Â  Â  Â  Â  task.wait(0.1)
Â  Â  end
end)

-- VÃ’NG Láº¶P AUTO COLLECT CHEST (RADA MODE)
task.spawn(function()
Â  Â  while true do
Â  Â  Â  Â  if AutoCollectChestState and hrp and hrp.Parent and hrp.Parent:FindFirstChildOfClass("Humanoid").Health > 0 then

Â  Â  Â  Â  Â  Â  local targetChest = nil
Â  Â  Â  Â  Â  Â  local shortestDistance = CollectChestRadius + 1
Â  Â  Â  Â  Â  Â  local hrpPosition = hrp.PositionÂ 

Â  Â  Â  Â  Â  Â  -- BÆ¯á»šC 1: TÃŒM Má»¤C TIÃŠU
Â  Â  Â  Â  Â  Â  for _, child in ipairs(workspace:GetDescendants()) do
Â  Â  Â  Â  Â  Â  Â  Â  if child.Name == CHEST_MODEL_NAME and child:IsA("Model") then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local clickablePart = child:FindFirstChild(CLICKABLE_PART_NAME)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  -- CHá»ˆ XÃ‰T KHI PART CÃ“ CLICK DETECTOR
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if clickablePart and clickablePart:FindFirstChildOfClass("ClickDetector") then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if clickablePart:IsA("BasePart") then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local distance = (hrpPosition - clickablePart.Position).Magnitude
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if distance < shortestDistance then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  shortestDistance = distance
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  targetChest = clickablePart
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end

Â  Â  Â  Â  Â  Â  -- BÆ¯á»šC 2: TELEPORT VÃ€ CLICK
Â  Â  Â  Â  Â  Â  if targetChest then
Â  Â  Â  Â  Â  Â  Â  Â  local targetPos = targetChest.Position
Â  Â  Â  Â  Â  Â  Â  Â  -- Teleport Ä‘áº¿n vá»‹ trÃ­ cÃ¡ch target 5 studs
Â  Â  Â  Â  Â  Â  Â  Â  local offset = (hrpPosition - targetPos).Unit * 5

Â  Â  Â  Â  Â  Â  Â  Â  -- Sá»¬ Dá»¤NG Lá»†NH TELEPORT Máº NH HÆ N (Force CFrame)
Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  hrp.CFrame = CFrame.new(targetPos + offset)
Â  Â  Â  Â  Â  Â  Â  Â  end)

Â  Â  Â  Â  Â  Â  Â  Â  -- Äá»£i nhÃ¢n váº­t á»•n Ä‘á»‹nh vÃ  cháº¯c cháº¯n nÃ³ á»Ÿ Ä‘Ãºng chá»—
Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.15)

Â  Â  Â  Â  Â  Â  Â  Â  local clickDetector = targetChest:FindFirstChildOfClass("ClickDetector")
Â  Â  Â  Â  Â  Â  Â  Â  if clickDetector then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pcall(function()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  -- Gá»­i lá»‡nh click (tham sá»‘ thá»© 2 lÃ  khoáº£ng cÃ¡ch)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clickDetector:MouseClick(player, targetChest.Position, 0.1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  Â  Â  Â  Â  end

Â  Â  Â  Â  Â  Â  Â  Â  task.wait(0.5) -- Äá»£i 0.5 giÃ¢y trÆ°á»›c khi tÃ¬m hÃ²m tiáº¿p theo
Â  Â  Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  Â  Â  task.wait(1.0) -- KhÃ´ng tÃ¬m tháº¥y hÃ²m nÃ o trong pháº¡m vi, Ä‘á»£i lÃ¢u hÆ¡n
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  task.wait(0.5)
Â  Â  Â  Â  end
Â  Â  end
end)

local foot=Instance.new("TextLabel")
foot.Size=UDim2.new(1,0,0,16)
foot.Position=UDim2.new(0,0,1,-16)
foot.BackgroundTransparency=1
foot.Font = Enum.Font.Gotham
foot.TextSize = 11
foot.TextColor3 = Color3.fromRGB(150,150,150)
foot.Text="NTBA â€¢ Farm Hub v21.2.6 (Auto Haki Adaptive/Spam - ÄÃ£ sá»­a lá»—i UI)"Â 
foot.Parent=Main

-- Cleanup khi player leave
if player then
Â  Â  player.AncestryChanged:Connect(function()
Â  Â  Â  Â  mainLoopActive = false
Â  Â  Â  Â  pcall(function() ScreenGui:Destroy() end)
Â  Â  end)
end

print("NTBA Farm Hub v21.2.6 - ÄÃ£ sá»­a lá»—i UI vÃ  sáºµn sÃ ng sá»­ dá»¥ng.")
