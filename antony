-- Auto Key Presser v11 - Tab Menu
-- Tác giả: NTBA (customized)

local Players = game:GetService("Players")
local VirtualInputManager = game:GetService("VirtualInputManager")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local toggles = {}

-- GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoKeyPresserGUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = game:GetService("CoreGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 240, 0, 320)
frame.Position = UDim2.new(0, 50, 0, 50)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Visible = true
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = frame

local stroke = Instance.new("UIStroke")
stroke.Thickness = 1.2
stroke.Transparency = 0.6
stroke.Color = Color3.fromRGB(200, 200, 200)
stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
stroke.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "Auto Key Presser v11"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 22
title.Parent = frame

-- Tabs
local tabBar = Instance.new("Frame")
tabBar.Size = UDim2.new(1, 0, 0, 30)
tabBar.Position = UDim2.new(0, 0, 0, 30)
tabBar.BackgroundTransparency = 1
tabBar.Parent = frame

local function createTabButton(name, order)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.5, -5, 1, 0)
    btn.Position = UDim2.new((order-1)*0.5, (order-1)*5, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.Text = name
    btn.Parent = tabBar
    return btn
end

local farmFruitTab = createTabButton("Farm Fruit", 1)
local farmHakiTab = createTabButton("Farm Haki", 2)

-- Content Frames
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, 0, 1, -60)
contentFrame.Position = UDim2.new(0, 0, 0, 60)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = frame

local farmFruitFrame = Instance.new("Frame")
farmFruitFrame.Size = UDim2.new(1, 0, 1, 0)
farmFruitFrame.BackgroundTransparency = 1
farmFruitFrame.Parent = contentFrame

local farmHakiFrame = Instance.new("Frame")
farmHakiFrame.Size = UDim2.new(1, 0, 1, 0)
farmHakiFrame.BackgroundTransparency = 1
farmHakiFrame.Visible = false
farmHakiFrame.Parent = contentFrame

-- Tab switching
farmFruitTab.MouseButton1Click:Connect(function()
    farmFruitFrame.Visible = true
    farmHakiFrame.Visible = false
end)

farmHakiTab.MouseButton1Click:Connect(function()
    farmFruitFrame.Visible = false
    farmHakiFrame.Visible = true
end)

-- Auto Farm Fruit (Z,X,C,V)
local keysFruit = {"Z", "X", "C", "V"}

local function autoPress(key)
    while toggles[key] do
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode[key], false, game)
        task.wait(0.1)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode[key], false, game)
        task.wait(0.5)
    end
end

for i, key in ipairs(keysFruit) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -20, 0, 40)
    btn.Position = UDim2.new(0, 10, 0, 50 * (i-1))
    btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.SourceSans
    btn.TextSize = 20
    btn.Text = key .. ": OFF"
    btn.Parent = farmFruitFrame

    toggles[key] = false
    btn.MouseButton1Click:Connect(function()
        toggles[key] = not toggles[key]
        btn.Text = key .. ": " .. (toggles[key] and "ON" or "OFF")
        if toggles[key] then
            task.spawn(function() autoPress(key) end)
        end
    end)
end

-- Auto Farm Haki (R giữ 3s)
local btnR = Instance.new("TextButton")
btnR.Size = UDim2.new(1, -20, 0, 40)
btnR.Position = UDim2.new(0, 10, 0, 10)
btnR.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
btnR.TextColor3 = Color3.fromRGB(255, 255, 255)
btnR.Font = Enum.Font.SourceSans
btnR.TextSize = 20
btnR.Text = "R: OFF"
btnR.Parent = farmHakiFrame

toggles["R"] = false
btnR.MouseButton1Click:Connect(function()
    toggles["R"] = not toggles["R"]
    btnR.Text = "R: " .. (toggles["R"] and "ON" or "OFF")
end)

-- Loop giữ R 3s, nghỉ 0.5s
task.spawn(function()
    while true do
        if toggles["R"] then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.R, false, game)
            task.wait(3) -- giữ 3s
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.R, false, game)
            task.wait(0.5) -- nghỉ 0.5s
        else
            task.wait(0.1)
        end
    end
end)

-- Toggle GUI bằng RightControl
local lastToggle = 0
RunService.Heartbeat:Connect(function()
    if UserInputService:IsKeyDown(Enum.KeyCode.RightControl) then
        if tick() - lastToggle > 0.3 then
            frame.Visible = not frame.Visible
            lastToggle = tick()
        end
    end
end)
